(function(){var d=function(){try{return(document.createElement("canvas").toDataURL("image/webp").indexOf("data:image/webp")==0)}catch(o){return false}};var n=d();var e=function(){var o=this;o.init();o.bindEvents()};e.prototype={switchInterval:null,switchTime:5000,init:function(){var o=this;$.ajax({url:"https://api2.firefoxchina.cn/home/chome_tb_pmt_scroll.json",dataType:"json",error:function(){},success:function(t){if(t&&t.data&&t.data.data){var p="<ul>",s="",u=4,q=20,y=h(t.data,"meta"),r=y.data,v=[];$.each(r,function(z,A){p+="<li for='tab-mod-"+A.track_key+"' class='menu' >"+A.title+"</li>"});p+="</ul>";$(".tab-menu").html(p);$.each(r,function(A,C){var B=[],z="<div class='dot-list'>";s+="<div class='tab-mod' trace-key='side_frame_"+C.track_key+"' id='tab-mod-"+C.track_key+"'>";s+="<div class='scroll-wrapper'><div class='scroller'>";if(C.data&&C.data.length){var D=0;$.each(C.data,function(G,E){var F=E.data;if(F&&F.length){$.each(F,function(J,K){++D;if(D<=q){if(D%u==1){z+="<span class='dot"+(D==1?" on":"")+"'></span>";s+="<div class='mod page'>"}var H=K.imgurl,I=H.replace(/\/jfs\//,"/s150x150_jfs/");s+="<div class='inner-mod'>";s+="<a href='"+K.url+"' title='"+K.title+"' target='_blank'>";s+="<p class='cover'><img src='' class='img-load-delay'  data-url='"+I+"' alt='"+K.title+"'> </p>";s+="<p class='title'>"+K.title+"</p>";if(K.intro){s+="<p class='price'>￥"+(K.intro)+"</p>"}else{if(K.meta&&K.meta.zk_final_price){s+="<p class='price'>￥"+(K.meta.zk_final_price)+"</p>"}}s+="</a></div>";if(D%u==0){s+="</div>"}}})}})}z+="</div>";s+="</div>";s+=z;s+="</div></div>"});$(".tab-detail").html(s);var x=$(".scroll-wrapper");var w={};TabWidget.build($(".tab-menu"),function(B){if(w[B]){w[B].showPage(0);return}var z=$("#"+B);var A=MozillaFPic.build({container:z.find(".scroller"),dotEle:z.find(".dot-list"),auto:false});w[B]=A});TabWidget.randSwitch($(".tab-menu"),function(B){if(w[B]){return}var z=$("#"+B);MozillaTool.loadDelayResource(z);var A=MozillaFPic.build({container:z.find(".scroller"),dotEle:z.find(".dot-list"),auto:false});w[B]=A});TraceWidget.build()}}})},generateTabContent:function(q,y){var M=this;if(!(q&&y&&y.length)){return}if(q.getAttribute("data-loaded")){return}q.setAttribute("data-loaded","true");var L=q.getAttribute("track-key");var F=0,T=8,I=1,s=y.length,r="",u=null,O="",Q=q,N=document.getElementById("thumb-switch");if(s){y.sort(function(){return Math.random()>0.5?1:-1});var x=document.createDocumentFragment();var A=Math.ceil(s/(T*I));for(var R=0;R<A;R++){var w=document.createElement("div"),v=document.createElement("p"),t=document.createElement("p");w.className="page";v.className="line";t.className="line";for(F=R*T*I;F<(R+1)*T*I;F++){var H=y[F],o=false,U=document.createElement("div"),P=document.createElement("a"),S=document.createElement("a"),D=document.createElement("p"),E=document.createElement("a"),C=document.createElement("span"),B=document.createElement("del"),V=document.createElement("span");if(H&&H.meta){if(!u){o=true;u=U}var J=H.meta.zk_final_price||H.meta.itemFinalPrice||H.meta.price,W=H.meta.reserve_price,K=H.meta.sales?(parseInt(H.meta.sales)>100?H.meta.sales:""):"",Y="https://"+H.imgurl||H.imgurl_https,G=Y.replace(/\s+/,""),z=((G.indexOf(".alicdn.")!=-1)?G+"_140x140":(G.indexOf("/jfs/")!=-1?G.replace(/\/jfs\//,"/s140x140_jfs/"):G));imgSRC=(R==0?z:"");imgClass=(R!=0?"img-load-delay":""),linkURL=H.meta.click_url||H.meta.sale_link||H.url,couponLink=H.meta.coupon_link||H.meta.coupon_click_url,title=H.title,newTitle=m(title,34);var X="<img src='"+imgSRC+"' alt='"+title+"'  data-img='"+z+"' class='"+imgClass+"'/>";P.className="cover";P.href=linkURL;P.title=title;P.innerHTML=X;S.className="title";S.href=linkURL;S.innerHTML=newTitle;S.title=title;U.className="mod";U.appendChild(P);U.appendChild(S);H.showPrice="";D.className="extra";if(J){C.className="price";C.innerHTML="￥"+J;D.appendChild(C)}if(W){B.innerHTML="￥"+W;D.appendChild(B)}U.appendChild(D);P.onclick=function(){i(this,L)};S.onclick=function(){i(this,L)};if(couponLink){E.onclick=function(){i(this,L)}}if(I>1){if(F<R*T*I+T){v.appendChild(U)}else{if(F<(R+1)*T*I){t.appendChild(U)}}}else{if(F<R*T*I+T){v.appendChild(U)}}if(F==(R+1)*T*I-1||F==s-1){w.appendChild(v);x.appendChild(w)}}}}q.appendChild(x)}},bindEvents:function(){var q=this,p=document.getElementById("thumb-switch"),o=document.getElementById("thumb-list")}};var j=new e();function m(t,u){var s=t,p=u?u:40;if(s){var q=0,o,r=0,w="",v=false;while((o=s.charAt(q))){q++;if(/[^\x00-\xff]/.test(o)){r=r+2;if(r<=p-2){w=w+o}}else{if(r<p){w=w+o}r=r+1}}s=w+(r>p?"...":"")}return s}function i(q,s){var o=q.href,t=q.title||"无关键字",p=s?s:"ad_frame_crack";if(o){var r=new Image(),u="";r.src="https://home.firefoxchina.cn/2019/img/trace_2014.gif?r="+Math.random()+"&d="+encodeURIComponent(document.location.host)+"&c="+encodeURIComponent(p)+"&a="+encodeURIComponent("")+"&u="+encodeURIComponent(o)+"&cid="+encodeURIComponent(u)+"&t="+encodeURIComponent(t)}}function l(p){var q=p.nextSibling;if(q==null){return null}if(q.nodeType==3){var o=l(q);if(o.nodeType==1){return o}}else{if(q.nodeType==1){return q}else{return false}}}function f(x,v){if(!v){v=0}var s=x.toString(),q=v.toString(),y=s.split("."),w=q.split("."),r=y[1]?y[1].length:0,p=w[1]?w[1].length:0,t=Math.max(r,p),o=parseFloat(s)-parseFloat(q),u=o.toFixed(t);return u}function c(x,v){if(!v){v=0}if(!x){return""}var s=x.toString(),q=v.toString(),y=s.split("."),w=q.split("."),r=y[1]?y[1].length:0,p=w[1]?w[1].length:0,t=Math.max(r,p),o=parseFloat(s)+parseFloat(q),u=o.toFixed(t);return u}function k(q){var p={type:"get",url:"#",dataType:"text",jsonp:"callback",data:{},async:true,success:function(r){}};for(var o in q){p[o]=q[o]}if(p.dataType=="jsonp"){b(p)}else{a(p)}}function a(q){var s=null;if(window.XMLHttpRequest){s=new XMLHttpRequest()}else{s=new ActiveXObject("Microsoft.XMLHTTP")}var r="";for(var o in q.data){r+=o+"="+q.data[o]+"&"}if(r){r=r.slice(0,r.length-1)}if(q.type=="get"){q.url+="?"+encodeURI(r)}s.open(q.type,q.url,q.async);var p=null;if(q.type=="post"){p=r;s.setRequestHeader("Content-Type","application/x-www-form-urlencoded")}s.send(p);if(!q.async){if(q.dataType=="json"){return JSON.parse(s.responseText)}else{return s.responseText}}s.onreadystatechange=function(){if(s.readyState==4){if(s.status==200){var t=s.responseText;if(q.dataType=="json"){t=JSON.parse(t)}q.success(t)}}}}function b(s){var r="jQuery"+("1.12.2"+Math.random()).replace(/\D/g,"")+"_"+(new Date().getTime());if(s.jsonpCallback){r=s.jsonpCallback}window[r]=function(u){s.success(u)};var t="";for(var q in s.data){t+=q+"="+s.data[q]+"&"}if(t){t=t.slice(0,t.length-1);t="&"+t}var o=document.createElement("script");o.src=s.url+"?"+s.jsonp+"="+r+t;var p=document.getElementsByTagName("head")[0];p.appendChild(o)}function h(r,p){var s=g(r,p);s&&(r=s);if(r.data){var o=r.data.length;if(o>0){for(var q=0;q<o;q++){r.data[q]=h(r.data[q],p)}}}return r}function g(q,o){var r="";var p=q[o],r=p;if(p&&typeof(p)=="string"){r=JSON.parse(p)}q[o]=r;return q}})();